# UNO çº¸ç‰Œæ¸¸æˆ ğŸ®

ä¸€ä¸ªç”¨ Rust è¯­è¨€å®ç°çš„ç»å…¸ UNO çº¸ç‰Œæ¸¸æˆï¼(æ­£åœ¨å¼€å‘ä¸­)

## åŠŸèƒ½æ¦‚è§ˆ

- æ ¸å¿ƒ UNO è§„åˆ™ï¼šé¢œè‰²/æ•°å­—/åŠŸèƒ½ç‰ŒåŒ¹é…ï¼Œåè½¬ã€è·³è¿‡ã€æŠ½2ã€ä¸‡èƒ½ã€ä¸‡èƒ½+4 ç­‰
- å¤šç©å®¶å¯¹æˆ˜ï¼ˆé€šè¿‡æœ¬åœ° TCP è¿æ¥ï¼‰
- äº‹ä»¶é©±åŠ¨çš„æ¸¸æˆå¼•æ“ä¸åè®®ï¼ˆJSON Linesï¼‰
- ä¸¤ç§å½¢æ€
  - æœåŠ¡ç«¯ï¼š`server`
  - ç»ˆç«¯ TUI å®¢æˆ·ç«¯ï¼š`tui_client`

## è¿è¡Œç¯å¢ƒ

- Rust 1.70+ï¼ˆ2021 Editionï¼‰
- Windowsã€macOSã€Linux å‡å¯
- é»˜è®¤æœåŠ¡ç›‘å¬/å®¢æˆ·ç«¯è¿æ¥åœ°å€ï¼š`127.0.0.1:9000`

## å¿«é€Ÿä½“éªŒ

- æ„å»º
  - `cargo build`
- å¯åŠ¨æœåŠ¡ç«¯ï¼ˆçª—å£1ï¼‰
  - `cargo run --bin server`
- å¯åŠ¨ TUI å®¢æˆ·ç«¯ï¼ˆçª—å£2ï¼‰
  - `cargo run --bin tui_client`

æç¤ºï¼šç¬¬ä¸€æ¬¡è¿è¡Œä¼šä¸‹è½½æ„å»ºä¾èµ–ï¼Œæ—¶é—´ç•¥é•¿ã€‚

## TUI å®¢æˆ·ç«¯æ“ä½œè¯´æ˜

è¿æ¥ååœ¨ TUI çª—å£æŒ‰é”®æ“ä½œï¼š

- Jï¼šåŠ å…¥æ¸¸æˆï¼ˆæ˜µç§°é»˜è®¤å–ç¯å¢ƒå˜é‡ USERNAME/USERï¼‰
- Sï¼šå¼€å§‹æ¸¸æˆï¼ˆå½“å‰ç©å®¶ä¸ºæˆ¿ä¸»æ—¶å¯è§¦å‘ï¼‰
- â†/â†’ï¼šç§»åŠ¨æ‰‹ç‰Œå…‰æ ‡
- Enterï¼šå‡ºç‰Œ
  - å½“é€‰æ‹©â€œä¸‡èƒ½/ä¸‡èƒ½+4â€ä¸”æœªæŒ‡å®šé¢œè‰²æ—¶ï¼ŒæŒ‰ä¸‹ Enter åä½¿ç”¨ R/G/B/Y é€‰æ‹©é¢œè‰²
- Dï¼šæ‘¸ç‰Œ
- Pï¼šè·³è¿‡
- Uï¼šå‡ºç‰Œå¹¶åŒæ—¶å–Š UNOï¼ˆå½“æ‰‹ç‰Œæ•°ä¸º 2 ä¸”å‡†å¤‡å‡ºç¬¬ 2 å¼ æ—¶ï¼‰
- Q æˆ– Escï¼šé€€å‡ºå®¢æˆ·ç«¯
- é¢œè‰²é€‰æ‹©ï¼ˆå½“éœ€è¦é€‰æ‹©æ—¶ï¼‰ï¼š
  - R = çº¢ï¼ŒG = ç»¿ï¼ŒB = è“ï¼ŒY = é»„

ç•Œé¢åŒºåŸŸï¼š
- å·¦ä¾§ï¼šç©å®¶ä¸å„è‡ªå‰©ä½™æ‰‹ç‰Œæ•°ï¼ˆâ€œâ†â€æŒ‡å‘å½“å‰å›åˆï¼‰
- ä¸­é—´ï¼šæ¡Œé¢çŠ¶æ€ï¼ˆé¡¶ç‰Œä¸æ“ä½œæç¤ºï¼‰
- å³ä¾§ï¼šä½ çš„æ‰‹ç‰Œï¼ˆâ€œ[]â€åŒ…è£¹çš„æ˜¯å½“å‰å…‰æ ‡æ‰€é€‰ï¼‰
- åº•éƒ¨ï¼šæœ€è¿‘æ—¥å¿—

## é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ lib.rs
â”œâ”€â”€ bin/
â”‚   â”œâ”€â”€ client.rs        # å‘½ä»¤è¡Œå®¢æˆ·ç«¯å…¥å£
â”‚   â”œâ”€â”€ server.rs        # æœåŠ¡ç«¯å…¥å£
â”‚   â””â”€â”€ tui_client.rs    # TUI å®¢æˆ·ç«¯å…¥å£ï¼ˆratatui/crosstermï¼‰
â”œâ”€â”€ game/
â”‚   â”œâ”€â”€ cards.rs         # å¡ç‰Œä¸é¢œè‰²/ç‚¹æ•°/åŠŸèƒ½å®šä¹‰
â”‚   â”œâ”€â”€ events.rs        # æ¸¸æˆäº‹ä»¶ï¼ˆå¼•æ“ -> å®¢æˆ·ç«¯ï¼‰
â”‚   â”œâ”€â”€ mod.rs
â”‚   â”œâ”€â”€ player.rs        # ç©å®¶ä¸æ‰‹ç‰Œé€»è¾‘
â”‚   â””â”€â”€ uno_game.rs      # æ¸¸æˆå¼•æ“
â”œâ”€â”€ ports/
â”‚   â”œâ”€â”€ bus.rs           # äº‹ä»¶æ€»çº¿/æ¶ˆæ¯ç«¯å£
â”‚   â””â”€â”€ mod.rs
â””â”€â”€ protocol/
    â”œâ”€â”€ client2server.rs # å®¢æˆ·ç«¯ -> æœåŠ¡ç«¯ åè®®ï¼ˆJSONï¼‰
    â”œâ”€â”€ mod.rs
    â””â”€â”€ server2client.rs # æœåŠ¡ç«¯ -> å®¢æˆ·ç«¯ åè®®ï¼ˆJSONï¼‰

tests/
â”œâ”€â”€ bus_test.rs
â”œâ”€â”€ cards_test.rs
â”œâ”€â”€ game_test.rs
â””â”€â”€ player_test.rs
```

## åè®®ä¸é€šä¿¡

- ä¼ è¾“ï¼šåŸºäº TCP çš„ JSON Linesï¼ˆæ¯æ¡æ¶ˆæ¯ä¸€è¡Œ JSONï¼‰
- å®¢æˆ·ç«¯å†™å…¥ï¼š`serde_json::to_string` + `writeln!()`
- æœåŠ¡ç«¯è¯»å–ï¼šé€è¡Œè§£æä¸º `protocol::*` æšä¸¾
- é‡è¦äº‹ä»¶ï¼š`game/events.rs` ä¸­çš„ `GameEvent`ï¼ˆå¦‚ PlayerTurnã€CardPlayedã€TopCardChanged ç­‰ï¼‰

## æµ‹è¯•

- è¿è¡Œå…¨éƒ¨æµ‹è¯•
  - `cargo test -- --show-output`
- è¿è¡ŒæŒ‡å®šæµ‹è¯•æ¨¡å—
  - `cargo test cards_test`
  - `cargo test game_test`
  - `cargo test player_test`

## ä¾èµ–

- UIï¼š`ratatui`ã€`crossterm`
- å¹¶å‘/é€šé“ï¼š`flume`
- åºåˆ—åŒ–ï¼š`serde`ã€`serde_json`
- éšæœºï¼š`rand`


## è´¡çŒ®

æ¬¢è¿ Issue / PRï¼š

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºåˆ†æ”¯ï¼š`git checkout -b feature/your-feature`
3. æäº¤ï¼š`git commit -m "feat: your feature"`
4. æ¨é€ï¼š`git push origin feature/your-feature`
5. å‘èµ· Pull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ GPLv3 è®¸å¯è¯ï¼Œè¯¦è§ [LICENSE](./LICENSE)ã€‚
